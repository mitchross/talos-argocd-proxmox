# infrastructure/controllers/argocd/apps/values.yaml
deployment:
  replicaCount: 1

garage:
  replicationFactor: "1"
  rpcBindAddr: "[::]:3901"
  # Generate these with: openssl rand -hex 32
  admin_token: "2ec9bf4ca836db5d7ad57903d91bdb5e5365fc062fa74b228fc1fc916fef6ebe"
  metrics_token: "2ec9bf4ca836db5d7ad57903d91bdb5e5365fc062fa74b228fc1fc916fef6ebe"
  dbEngine: "lmdb"  # or "sqlite" if preferred

  s3:
    api:
      region: "garage"
      rootDomain: ".s3.garage.local"
    web:
      rootDomain: ".web.garage.local"
      index: "index.html"

persistence:
  enabled: true
  meta:
    size: "1Gi"
    storageClass: "longhorn"
  data:
    size: "10Gi"
    storageClass: "longhorn"

service:
  type: ClusterIP
  # Ensure admin API is exposed through the Service so in-cluster clients (webui)
  # can reach port 3903. The upstream chart will render these ports if it uses
  # a `service.ports` values structure. If the chart uses a different shape,
  # adapt accordingly.
  ports:
    - name: s3-api
      port: 3900
      targetPort: 3900
      protocol: TCP
    - name: s3-web
      port: 3902
      targetPort: 3902
      protocol: TCP
    - name: admin
      port: 3903
      targetPort: 3903
      protocol: TCP

# Optional: enable metrics for Prometheus
# monitoring:
#   metrics:
#     enabled: true